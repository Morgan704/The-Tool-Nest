<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SEO Backlink Checker — Nest</title>
  <link rel="stylesheet" href="../assets/styles.css">
  <style>
    body { font-family: Arial, sans-serif; background:#f9f9f9; margin:0; padding:0; }
    .tool-container { max-width: 900px; margin: 60px auto; padding: 30px; background:#fff; border-radius: 12px; box-shadow:0 6px 20px rgba(0,0,0,0.1); }
    h1 { margin-top:0; }
    textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; resize:vertical; }
    table { width:100%; border-collapse:collapse; margin-top:20px; }
    th, td { border:1px solid #ddd; padding:8px; text-align:left; font-size:14px; }
    th { background:#f0f0f0; }
    .btn { padding:10px 18px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; margin-top:10px; }
    .btn-primary { background:#007bff; color:#fff; }
    .btn-secondary { background:#ddd; color:#000; }
  </style>
</head>
<body>

<div class="tool-container">
  <a href="../index.html">← Home</a>
  <h1>SEO Backlink Checker (Pro)</h1>
  <p>Paste HTML source code of a page to extract backlinks (anchor text, URL, dofollow/nofollow).</p>

  <textarea id="htmlInput" rows="8" placeholder="Paste HTML code here..."></textarea>
  <br>
  <button id="analyze" class="btn btn-primary">Analyze Backlinks</button>
  <button id="export" class="btn btn-secondary" disabled>Export CSV</button>

  <table id="resultsTable" style="display:none;">
    <thead>
      <tr>
        <th>#</th>
        <th>Anchor Text</th>
        <th>URL</th>
        <th>Rel</th>
        <th>Type</th>
      </tr>
    </thead>
    <tbody id="resultsBody"></tbody>
  </table>
</div>

<script>
const analyzeBtn = document.getElementById("analyze");
const exportBtn = document.getElementById("export");
const htmlInput = document.getElementById("htmlInput");
const resultsTable = document.getElementById("resultsTable");
const resultsBody = document.getElementById("resultsBody");

let backlinks = [];

analyzeBtn.addEventListener("click", ()=>{
  const html = htmlInput.value.trim();
  if(!html){ alert("Paste some HTML code first."); return; }

  const parser = new DOMParser();
  const doc = parser.parseFromString(html, "text/html");
  const links = doc.querySelectorAll("a[href]");
  
  backlinks = [];
  resultsBody.innerHTML = "";
  let index = 1;

  links.forEach(link=>{
    const anchor = link.textContent.trim() || "(no text)";
    const href = link.getAttribute("href");
    const rel = link.getAttribute("rel") || "";
    const type = rel.includes("nofollow") ? "Nofollow" : "Dofollow";

    backlinks.push({ anchor, href, rel, type });

    const row = `<tr>
      <td>${index++}</td>
      <td>${anchor}</td>
      <td>${href}</td>
      <td>${rel}</td>
      <td>${type}</td>
    </tr>`;
    resultsBody.insertAdjacentHTML("beforeend", row);
  });

  resultsTable.style.display = backlinks.length ? "table" : "none";
  exportBtn.disabled = backlinks.length === 0;
});

exportBtn.addEventListener("click", ()=>{
  if(!backlinks.length) return;

  let csv = "Anchor Text,URL,Rel,Type\n";
  backlinks.forEach(b=>{
    csv += `"${b.anchor.replace(/"/g, '""')}","${b.href}","${b.rel}","${b.type}"\n`;
  });

  const blob = new Blob([csv], {type:"text/csv"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "backlinks.csv";
  a.click();
  URL.revokeObjectURL(url);
});
</script>

</body>
</html>
