<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Password Generator — The Tool Nest</title>

  <!-- Tailwind & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <style>
    .strength-dot{width:18px;height:8px;border-radius:9999px}
    .dot-weak{background:#ef4444}.dot-ok{background:#f59e0b}.dot-good{background:#10b981}.dot-strong{background:#059669}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-sm border-b">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <i class="fas fa-key text-2xl text-green-600"></i>
          <h1 class="text-2xl font-bold text-gray-900">Password Generator</h1>
        </div>
        <a href="/" class="text-sm text-gray-600 hover:text-green-600">← Back to Home</a>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-lg shadow-sm border">
      <div class="p-6 space-y-6">
        <!-- Output -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Generated Password</label>
          <div class="flex">
            <input id="passwordOut" type="text" readonly class="mono flex-1 border border-gray-300 rounded-l-md px-3 py-2 bg-gray-50 focus:outline-none" placeholder="Click Generate"/>
            <button id="toggleMask" class="px-3 border-t border-b border-gray-300 bg-white hover:bg-gray-50" title="Show/Hide">
              <i class="fas fa-eye-slash"></i>
            </button>
            <button id="copyBtn" class="px-4 rounded-r-md bg-green-600 text-white hover:bg-green-700 focus:outline-none">
              <i class="far fa-copy mr-1"></i> Copy
            </button>
          </div>
        </div>

        <!-- Strength -->
        <div class="space-y-2">
          <div class="flex items-center justify-between">
            <span class="text-sm text-gray-700 font-medium">Strength</span>
            <span id="strengthLabel" class="text-sm font-semibold text-gray-700">–</span>
          </div>
          <div class="flex space-x-2">
            <div id="d1" class="strength-dot bg-gray-200"></div>
            <div id="d2" class="strength-dot bg-gray-200"></div>
            <div id="d3" class="strength-dot bg-gray-200"></div>
            <div id="d4" class="strength-dot bg-gray-200"></div>
          </div>
        </div>

        <!-- Controls -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-4">
            <div>
              <label for="len" class="block text-sm font-medium text-gray-700 mb-1">
                Length: <span id="lenVal" class="font-semibold">16</span>
              </label>
              <input id="len" type="range" min="6" max="64" value="16" class="w-full">
            </div>

            <div class="grid grid-cols-2 gap-3 text-sm">
              <label class="flex items-center space-x-2">
                <input id="lower" type="checkbox" class="h-4 w-4 text-green-600" checked>
                <span>Lowercase (a–z)</span>
              </label>
              <label class="flex items-center space-x-2">
                <input id="upper" type="checkbox" class="h-4 w-4 text-green-600" checked>
                <span>Uppercase (A–Z)</span>
              </label>
              <label class="flex items-center space-x-2">
                <input id="nums" type="checkbox" class="h-4 w-4 text-green-600" checked>
                <span>Numbers (0–9)</span>
              </label>
              <label class="flex items-center space-x-2">
                <input id="syms" type="checkbox" class="h-4 w-4 text-green-600" checked>
                <span>Symbols (!@#$…)</span>
              </label>
              <label class="flex items-center space-x-2">
                <input id="avoidAmb" type="checkbox" class="h-4 w-4 text-green-600">
                <span>Avoid ambiguous (O0lI…)</span>
              </label>
              <label class="flex items-center space-x-2">
                <input id="noDup" type="checkbox" class="h-4 w-4 text-green-600">
                <span>No duplicate chars</span>
              </label>
            </div>
          </div>

          <div class="space-y-4">
            <label class="block text-sm font-medium text-gray-700">Generate Multiple</label>
            <div class="flex items-center space-x-3">
              <input id="batchCount" type="number" min="1" max="50" value="1" class="w-24 border border-gray-300 rounded-md px-3 py-2">
              <button id="genBtn" class="bg-green-600 text-white px-5 py-2 rounded-md hover:bg-green-700">
                <i class="fas fa-bolt mr-2"></i>Generate
              </button>
              <button id="resetBtn" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700">
                <i class="fas fa-rotate-left mr-1"></i>Reset
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Batch Results</label>
              <textarea id="batchOut" rows="6" readonly class="mono w-full border border-gray-300 rounded-md p-3 bg-gray-50" placeholder="Multiple passwords will appear here (one per line)"></textarea>
              <div class="mt-2 flex gap-2">
                <button id="copyBatch" class="px-3 py-1.5 border rounded-md hover:bg-gray-50"><i class="far fa-copy mr-1"></i> Copy List</button>
                <button id="downloadBatch" class="px-3 py-1.5 border rounded-md hover:bg-gray-50"><i class="fas fa-file-arrow-down mr-1"></i> Download .txt</button>
              </div>
            </div>
          </div>
        </div>

        <p class="text-xs text-gray-500">Tip: Use 16+ characters with all sets for best strength. Never reuse passwords.</p>
      </div>
    </div>
  </main>

  <!-- Toasts -->
  <div id="toastContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <script>
    // Elements
    const out = document.getElementById('passwordOut');
    const batchOut = document.getElementById('batchOut');
    const len = document.getElementById('len');
    const lenVal = document.getElementById('lenVal');
    const lower = document.getElementById('lower');
    const upper = document.getElementById('upper');
    const nums  = document.getElementById('nums');
    const syms  = document.getElementById('syms');
    const avoidAmb = document.getElementById('avoidAmb');
    const noDup = document.getElementById('noDup');
    const genBtn = document.getElementById('genBtn');
    const resetBtn = document.getElementById('resetBtn');
    const copyBtn = document.getElementById('copyBtn');
    const toggleMask = document.getElementById('toggleMask');
    const strengthLabel = document.getElementById('strengthLabel');
    const dots = [document.getElementById('d1'),document.getElementById('d2'),document.getElementById('d3'),document.getElementById('d4')];
    const batchCount = document.getElementById('batchCount');
    const copyBatch = document.getElementById('copyBatch');
    const downloadBatch = document.getElementById('downloadBatch');

    len.addEventListener('input', ()=> lenVal.textContent = len.value);

    // Character sets
    const sets = {
      lower: "abcdefghijklmnopqrstuvwxyz",
      upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
      nums : "0123456789",
      syms : "!@#$%^&*()-_=+[]{};:,.<>/?|~"
    };
    const ambiguous = /[O0oIl1|`'"]/g;

    function buildPool(){
      let pool = "";
      if(lower.checked) pool += sets.lower;
      if(upper.checked) pool += sets.upper;
      if(nums.checked)  pool += sets.nums;
      if(syms.checked)  pool += sets.syms;
      if(avoidAmb.checked) pool = pool.replace(ambiguous, "");
      return pool;
    }

    function generateOne(n){
      const pool = buildPool();
      if(!pool) return "";

      let pwd = "";
      // ensure at least one from each selected set
      const chosenSets = [];
      if(lower.checked) chosenSets.push(sets.lower.replace(avoidAmb.checked?ambiguous:"",""));
      if(upper.checked) chosenSets.push(sets.upper.replace(avoidAmb.checked?ambiguous:"",""));
      if(nums.checked)  chosenSets.push(sets.nums.replace(avoidAmb.checked?ambiguous:"",""));
      if(syms.checked)  chosenSets.push(sets.syms.replace(avoidAmb.checked?ambiguous:"",""));

      // Fill with randoms
      while(pwd.length < n){
        let ch;
        if(pwd.length < chosenSets.length){
          const s = chosenSets[pwd.length % chosenSets.length];
          ch = s[Math.floor(Math.random()*s.length)];
        } else {
          ch = pool[Math.floor(Math.random()*pool.length)];
        }
        if(noDup.checked && pwd.includes(ch)) continue;
        pwd += ch;
      }

      // Shuffle
      pwd = pwd.split('').sort(()=>Math.random()-0.5).join('');
      return pwd;
    }

    function zxcvbnishScore(p){
      // quick heuristic: length + variety
      let score = 0;
      if(p.length >= 12) score++;
      if(p.length >= 16) score++;
      const variety = [/[a-z]/,/[A-Z]/,/[0-9]/,/[^A-Za-z0-9]/].reduce((a,r)=>a+(r.test(p)?1:0),0);
      if(variety>=3) score++;
      if(variety===4) score++;
      return Math.min(score,4);
    }

    function updateStrength(p){
      const s = p ? zxcvbnishScore(p) : 0;
      const labels = ["Weak","OK","Good","Strong"];
      dots.forEach((d,i)=>{
        d.className = "strength-dot " + (i<s ? (["dot-weak","dot-ok","dot-good","dot-strong"][Math.min(s-1,3)]) : "bg-gray-200");
      });
      strengthLabel.textContent = p ? labels[Math.max(0,s-1)] : "–";
    }

    function toast(msg,type='info'){
      const colors = {success:'bg-green-600', error:'bg-red-600', info:'bg-blue-600', warning:'bg-yellow-500'};
      const el = document.createElement('div');
      el.className = `${colors[type]||colors.info} text-white px-4 py-2 rounded-md shadow-md transform transition-all translate-x-full`;
      el.textContent = msg;
      const wrap = document.getElementById('toastContainer');
      wrap.appendChild(el);
      requestAnimationFrame(()=> el.classList.remove('translate-x-full'));
      setTimeout(()=>{ el.classList.add('translate-x-full'); setTimeout(()=>wrap.removeChild(el),300); }, 3000);
    }

    genBtn.addEventListener('click', ()=>{
      const count = Math.max(1, Math.min(50, parseInt(batchCount.value)||1));
      const length = parseInt(len.value);
      let first = "";
      const lines = [];
      for(let i=0;i<count;i++){
        const p = generateOne(length);
        if(!first) first = p;
        lines.push(p);
      }
      out.value = first;
      updateStrength(first);
      batchOut.value = count>1 ? lines.join('\n') : "";
    });

    copyBtn.addEventListener('click', ()=>{
      if(!out.value) return toast("Nothing to copy","warning");
      navigator.clipboard.writeText(out.value).then(()=>toast("Copied password","success"));
    });

    copyBatch.addEventListener('click', ()=>{
      if(!batchOut.value) return toast("No batch results","warning");
      navigator.clipboard.writeText(batchOut.value).then(()=>toast("Copied list","success"));
    });

    downloadBatch.addEventListener('click', ()=>{
      if(!batchOut.value) return toast("No batch results","warning");
      const blob = new Blob([batchOut.value], {type:"text/plain"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'passwords.txt';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });

    toggleMask.addEventListener('click', ()=>{
      if(out.type === "password"){
        out.type = "text";
        toggleMask.innerHTML = '<i class="fas fa-eye-slash"></i>';
      } else {
        out.type = "password";
        toggleMask.innerHTML = '<i class="fas fa-eye"></i>';
      }
    });

    resetBtn.addEventListener('click', ()=>{
      len.value = 16; lenVal.textContent = "16";
      lower.checked = upper.checked = nums.checked = syms.checked = true;
      avoidAmb.checked = noDup.checked = false;
      batchCount.value = 1;
      out.type = "text";
      out.value = ""; batchOut.value = "";
      toggleMask.innerHTML = '<i class="fas fa-eye-slash"></i>';
      updateStrength("");
    });

    // Init
    out.type = "text";
    updateStrength("");
  </script>
</body>
</html>
