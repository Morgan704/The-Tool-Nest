<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>SEO SERP Preview — The Tool Nest</title>
<meta name="description" content="Preview how your page will look in Google search results. Live title & description truncation for desktop and mobile.">
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
<style>
  .gcard { background:#fff; border:1px solid #e5e7eb; border-radius:.5rem; padding:16px; }
  .gurl { color:#166534; font-size:.875rem }
  .gtitle { color:#1a0dab; font-size:1.125rem; line-height:1.3; }
  .gdesc { color:#4b5563; font-size:.875rem; }
</style>
</head>
<body class="bg-gray-50 min-h-screen">
<header class="bg-white shadow-sm border-b">
  <div class="max-w-5xl mx-auto px-4 py-4 flex items-center justify-between">
    <div class="flex items-center space-x-3">
      <i class="fas fa-search text-2xl text-blue-600"></i>
      <h1 class="text-2xl font-bold text-gray-900">SEO SERP Preview</h1>
    </div>
    <button id="helpBtn" class="text-gray-600 hover:text-blue-600"><i class="fas fa-question-circle text-xl"></i></button>
  </div>
</header>

<main class="max-w-5xl mx-auto px-4 py-8 space-y-6">
  <section class="bg-white rounded-lg shadow-sm border p-6 space-y-4">
    <div class="grid md:grid-cols-3 gap-4">
      <div class="md:col-span-2">
        <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
        <input id="title" class="w-full border rounded px-3 py-2" placeholder="Page title (≈ 600px on desktop)">
        <div class="text-xs text-gray-500 mt-1">Chars: <b id="tCount">0</b></div>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Device</label>
        <select id="device" class="w-full border rounded px-3 py-2">
          <option value="desktop" selected>Desktop</option>
          <option value="mobile">Mobile</option>
        </select>
      </div>
    </div>

    <div class="grid md:grid-cols-3 gap-4">
      <div class="md:col-span-2">
        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
        <textarea id="desc" rows="3" class="w-full border rounded px-3 py-2" placeholder="Meta description (≈ 920px desktop / 680px mobile)"></textarea>
        <div class="text-xs text-gray-500 mt-1">Chars: <b id="dCount">0</b></div>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">URL</label>
        <input id="url" class="w-full border rounded px-3 py-2" placeholder="https://toolnest.live/page-slug/">
      </div>
    </div>

    <div class="flex flex-wrap gap-3">
      <button id="example" class="bg-gray-200 px-3 py-2 rounded text-sm"><i class="fas fa-bolt mr-1"></i>Example</button>
      <button id="resetBtn" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"><i class="fas fa-trash mr-2"></i>Reset</button>
      <button id="copyBtn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"><i class="fas fa-copy mr-2"></i>Copy snippet (JSON-LD)</button>
    </div>

    <div class="gcard mt-4">
      <div class="gurl flex items-center gap-2 mb-1">
        <div class="w-5 h-5 rounded bg-green-700 flex items-center justify-center text-white text-xs">TN</div>
        <span id="previewUrl">toolnest.live › page-slug</span>
      </div>
      <div class="gtitle mb-1" id="previewTitle">Your title preview appears here</div>
      <div class="gdesc" id="previewDesc">Your description preview appears here.</div>
    </div>
  </section>
</main>

<!-- Help Modal -->
<div id="helpModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 max-w-lg w-full m-4">
    <div class="flex justify-between items-center mb-3">
      <h3 class="text-lg font-bold">Notes</h3>
      <button id="closeHelp" class="text-gray-500 hover:text-gray-700"><i class="fas fa-times"></i></button>
    </div>
    <ul class="text-sm text-gray-700 space-y-2">
      <li>Google truncates by **pixel width**, not exact characters. We simulate with typical cutoffs.</li>
      <li>Desktop: title ≈ 600px, description ≈ 920px. Mobile: title ≈ 580px, description ≈ 680px.</li>
      <li>Use clear value upfront; add brand at end if space allows.</li>
    </ul>
  </div>
</div>

<div id="toastContainer" class="fixed top-4 right-4 space-y-2 z-50"></div>

<script>
const titleEl=document.getElementById('title');
const descEl=document.getElementById('desc');
const urlEl=document.getElementById('url');
const device=document.getElementById('device');
const pTitle=document.getElementById('previewTitle');
const pDesc=document.getElementById('previewDesc');
const pUrl=document.getElementById('previewUrl');
const tCount=document.getElementById('tCount');
const dCount=document.getElementById('dCount');

function pxLimit(kind, dev){
  if(kind==='title') return dev==='mobile'? 580:600;
  return dev==='mobile'? 680:920;
}
function approxWidth(s){
  // crude width: letters ≈7px, spaces ≈3px, punctuation ≈5px
  let w=0;
  for(const ch of s){
    if(/\s/.test(ch)) w+=3;
    else if(/[.,:;!?\-–—]/.test(ch)) w+=5;
    else w+=7;
  }
  return w;
}
function truncateByPixels(s, limit){
  if(approxWidth(s)<=limit) return s;
  let out=''; let w=0;
  for(const ch of s){
    const add = /\s/.test(ch)?3:(/[.,:;!?\-–—]/.test(ch)?5:7);
    if(w+add>limit-20) break;
    out+=ch; w+=add;
  }
  return out.trimEnd()+'…';
}
function update(){
  tCount.textContent = titleEl.value.length;
  dCount.textContent = descEl.value.length;
  pTitle.textContent = truncateByPixels(titleEl.value || 'Your title preview appears here', pxLimit('title', device.value));
  pDesc.textContent = truncateByPixels(descEl.value || 'Your description preview appears here.', pxLimit('desc', device.value));
  const u = urlEl.value.trim() || 'https://toolnest.live/page-slug/';
  pUrl.textContent = u.replace(/^https?:\/\//,'').replace(/\/$/,'').replace(/\//g,' › ');
}
['input','change'].forEach(ev=>{
  titleEl.addEventListener(ev, update);
  descEl.addEventListener(ev, update);
  urlEl.addEventListener(ev, update);
  device.addEventListener(ev, update);
});
document.getElementById('example').addEventListener('click', ()=>{
  titleEl.value = 'Image Converter — Convert PNG, JPG & WebP Online | The Tool Nest';
  descEl.value = 'Fast, privacy-first image converter. Batch convert PNG, JPG, WebP and more—right in your browser. No upload. Free.';
  urlEl.value = 'https://toolnest.live/tools/image-converter/';
  update();
});
document.getElementById('resetBtn').addEventListener('click', ()=>{
  titleEl.value=''; descEl.value=''; urlEl.value=''; update(); toast('Cleared','info');
});
document.getElementById('copyBtn').addEventListener('click', async ()=>{
  const jsonld = {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "url": urlEl.value || "https://toolnest.live/",
    "name": titleEl.value || "Page Title",
    "description": descEl.value || "Meta description"
  };
  await navigator.clipboard.writeText('<script type="application/ld+json">'+JSON.stringify(jsonld)+'</script>');
  toast('JSON-LD copied','success');
});

// Help + toast
document.getElementById('helpBtn').addEventListener('click', ()=>document.getElementById('helpModal').classList.remove('hidden'));
document.getElementById('closeHelp').addEventListener('click', ()=>document.getElementById('helpModal').classList.add('hidden'));
document.getElementById('helpModal').addEventListener('click', e=>{ if(e.target.id==='helpModal') e.target.classList.add('hidden'); });

function toast(msg,type='info'){
  const c=document.getElementById('toastContainer'); const el=document.createElement('div');
  const color={success:'bg-green-500',error:'bg-red-500',info:'bg-blue-500',warning:'bg-yellow-500'}[type]||'bg-blue-500';
  el.className=`${color} text-white px-4 py-2 rounded shadow transform transition duration-300 translate-x-full`;
  el.textContent=msg; c.appendChild(el);
  setTimeout(()=>el.classList.remove('translate-x-full'),50);
  setTimeout(()=>{ el.classList.add('translate-x-full'); setTimeout(()=>el.remove(),250); },3200);
}
update();
</script>
</body>
</html>
