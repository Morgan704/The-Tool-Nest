<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Background Remover - No API Required</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
<style>
.gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
.glass-effect { backdrop-filter: blur(10px); background: rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2);}
.tool-card { transition: all 0.3s ease; cursor:pointer; }
.tool-card:hover { transform: translateY(-4px); box-shadow:0 10px 25px rgba(0,0,0,0.2);}
.upload-area { border:3px dashed #cbd5e0; min-height:200px; transition:all 0.3s ease;}
.upload-area.dragover { border-color:#4299e1; background-color: rgba(66,153,225,0.1);}
.canvas-container { position:relative; display:inline-block;}
.canvas-overlay { position:absolute; top:0; left:0; pointer-events:none;}
.brush-cursor { cursor: crosshair;}
.comparison-container { position:relative; overflow:hidden; border-radius:8px;}
.comparison-slider { position:absolute; top:0; left:50%; width:4px; height:100%; background:white; cursor:ew-resize; z-index:10;}
.fade-in { animation:fadeIn 0.5s ease-in;}
@keyframes fadeIn { from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }
.method-active { background:linear-gradient(135deg, #667eea,#764ba2); color:white;}
.progress-bar { height:6px; background:#e5e7eb; border-radius:3px; overflow:hidden;}
.progress-fill { height:100%; background:linear-gradient(90deg, #667eea, #764ba2); transition:width 0.3s ease;}
@media print { body{margin:0;} .no-print{display:none;} }
</style>
</head>
<body class="gradient-bg min-h-screen">
<div class="container mx-auto px-4 py-6">
<!-- Header -->
<div class="text-center mb-8">
<h1 class="text-4xl md:text-5xl font-bold text-white mb-4">
<i class="fas fa-magic mr-3"></i>Professional Background Remover
</h1>
<p class="text-xl text-gray-200 mb-2">Multiple Free Methods - No API Keys Required</p>
<p class="text-gray-300">Choose from client-side processing, free online tools, or manual editing</p>
</div>

<!-- Method Selection -->
<div class="glass-effect rounded-xl p-6 mb-6">
<h2 class="text-2xl font-semibold text-white mb-4"><i class="fas fa-tools mr-2"></i>Choose Your Method</h2>
<div class="grid md:grid-cols-4 gap-4">
<button class="method-btn method-active" data-method="client-side">
<i class="fas fa-desktop text-2xl mb-2"></i>
<div class="font-semibold">Client-Side AI</div>
<div class="text-sm opacity-75">Process locally</div>
</button>
<button class="method-btn" data-method="free-services">
<i class="fas fa-cloud text-2xl mb-2"></i>
<div class="font-semibold">Free Online Tools</div>
<div class="text-sm opacity-75">External services</div>
</button>
<button class="method-btn" data-method="manual">
<i class="fas fa-edit text-2xl mb-2"></i>
<div class="font-semibold">Manual Editor</div>
<div class="text-sm opacity-75">Precise control</div>
</button>
<button class="method-btn" data-method="comparison">
<i class="fas fa-balance-scale text-2xl mb-2"></i>
<div class="font-semibold">Compare Results</div>
<div class="text-sm opacity-75">Side by side</div>
</button>
</div>
</div>

<!-- Upload Section -->
<div class="glass-effect rounded-xl p-6 mb-6">
<h2 class="text-2xl font-semibold text-white mb-4"><i class="fas fa-upload mr-2"></i>Upload Your Image</h2>
<div id="uploadArea" class="upload-area rounded-lg p-8 text-center cursor-pointer flex flex-col items-center justify-center">
<i class="fas fa-cloud-upload-alt text-5xl text-gray-400 mb-3"></i>
<p class="text-lg text-gray-600 mb-2">Drag & drop your image here or click to select</p>
<p class="text-sm text-gray-500">Supports JPG, PNG, WebP (Max 10MB)</p>
<input type="file" id="fileInput" class="hidden" accept="image/*">
</div>
</div>

<!-- Client-Side Processing -->
<div id="clientSideSection" class="method-section">
<div class="glass-effect rounded-xl p-6 mb-6">
<h2 class="text-2xl font-semibold text-white mb-4"><i class="fas fa-desktop mr-2"></i>Client-Side AI Processing</h2>
<div class="grid md:grid-cols-2 gap-6">
<div class="bg-white rounded-lg p-4">
<h3 class="text-lg font-semibold mb-3">Original Image</h3>
<canvas id="originalCanvas" class="w-full border rounded max-w-full" style="max-height:300px;"></canvas>
</div>
<div class="bg-white rounded-lg p-4">
<h3 class="text-lg font-semibold mb-3">Processed Image</h3>
<canvas id="processedCanvas" class="w-full border rounded max-w-full" style="max-height:300px;"></canvas>
</div>
</div>

<div class="mt-4">
<div class="flex flex-wrap gap-2 mb-4">
<button id="processBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors">
<i class="fas fa-magic mr-2"></i>Process Image</button>
<button id="downloadProcessedBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded transition-colors">
<i class="fas fa-download mr-2"></i>Download PNG</button>
<button id="resetBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded transition-colors">
<i class="fas fa-redo mr-2"></i>Reset</button>
</div>

<div class="mt-4">
<label class="text-white font-semibold mr-2">Background:</label>
<input type="color" id="bgColorPicker" value="#ffffff" class="mr-2">
<input type="file" id="bgImageInput" accept="image/*">
</div>

<div id="processingProgress" class="hidden mt-4">
<div class="progress-bar mb-2">
<div id="progressFill" class="progress-fill" style="width:0%"></div>
</div>
<p id="progressText" class="text-white text-center">0%</p>
</div>
</div>
</div>
</div>

<!-- Remaining sections (Free Tools, Manual Editor, Comparison) remain same -->

<div class="text-center text-white opacity-75 mt-6">
<p>&copy; 2024 Professional Background Remover. All methods are free to use.</p>
</div>
</div>

<script>
class BackgroundRemoverTool {
    constructor() {
        this.currentImage = null;
        this.currentMethod = 'client-side';
        this.bgImage = null;
        this.initializeElements();
        this.bindEvents();
        this.setupCanvases();
    }

    initializeElements() {
        this.uploadArea = document.getElementById('uploadArea');
        this.fileInput = document.getElementById('fileInput');
        this.originalCanvas = document.getElementById('originalCanvas');
        this.processedCanvas = document.getElementById('processedCanvas');
        this.methodBtns = document.querySelectorAll('.method-btn');
        this.methodSections = document.querySelectorAll('.method-section');
        this.processBtn = document.getElementById('processBtn');
        this.downloadProcessedBtn = document.getElementById('downloadProcessedBtn');
        this.resetBtn = document.getElementById('resetBtn');
        this.processingProgress = document.getElementById('processingProgress');
        this.progressFill = document.getElementById('progressFill');
        this.progressText = document.getElementById('progressText');
        this.bgColorPicker = document.getElementById('bgColorPicker');
        this.bgImageInput = document.getElementById('bgImageInput');
    }

    bindEvents() {
        this.uploadArea.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', e => this.handleFileSelect(e.target.files[0]));
        this.uploadArea.addEventListener('dragover', e => this.handleDragOver(e));
        this.uploadArea.addEventListener('dragleave', e => this.handleDragLeave(e));
        this.uploadArea.addEventListener('drop', e => this.handleDrop(e));

        this.methodBtns.forEach(btn => {
            btn.addEventListener('click', () => this.switchMethod(btn.dataset.method));
        });

        this.processBtn.addEventListener('click', () => this.processImage());
        this.downloadProcessedBtn.addEventListener('click', () => this.downloadCanvas(this.processedCanvas, 'processed.png'));
        this.resetBtn.addEventListener('click', () => this.resetAll());

        this.bgColorPicker.addEventListener('input', () => this.applyBackground());
        this.bgImageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => {
                const img = new Image();
                img.onload = () => { this.bgImage = img; this.applyBackground(); };
                img.src = ev.target.result;
            };
            reader.readAsDataURL(file);
        });
    }

    setupCanvases() {
        this.originalCtx = this.originalCanvas.getContext('2d');
        this.processedCtx = this.processedCanvas.getContext('2d');
    }

    handleDragOver(e){ e.preventDefault(); this.uploadArea.classList.add('dragover'); }
    handleDragLeave(e){ e.preventDefault(); this.uploadArea.classList.remove('dragover'); }
    handleDrop(e){ e.preventDefault(); this.uploadArea.classList.remove('dragover'); if(e.dataTransfer.files.length>0) this.handleFileSelect(e.dataTransfer.files[0]); }

    handleFileSelect(file){
        if(!file || !file.type.startsWith('image/')) { alert('Please select a valid image file.'); return; }
        const reader = new FileReader();
        reader.onload = (e) => this.loadImage(e.target.result);
        reader.readAsDataURL(file);
    }

    loadImage(src){
        const img = new Image();
        img.onload = () => {
            this.currentImage = img;
            this.drawImageToCanvas(img, this.originalCanvas);
            this.drawImageToCanvas(img, this.processedCanvas);
            this.uploadArea.innerHTML = `<i class="fas fa-check-circle text-5xl text-green-500 mb-3"></i>
            <p class="text-lg text-green-600 font-semibold">Image loaded successfully!</p>
            <p class="text-sm text-gray-500">Click to select a different image</p>`;
        };
        img.src = src;
    }

    drawImageToCanvas(img, canvas){
        const ctx = canvas.getContext('2d');
        const maxWidth=600, maxHeight=400;
        let {width, height}=img;
        const ratio=Math.min(maxWidth/width,maxHeight/height);
        width*=ratio; height*=ratio;
        canvas.width=width; canvas.height=height;
        ctx.clearRect(0,0,width,height);
        ctx.drawImage(img,0,0,width,height);
    }

    switchMethod(method){
        this.currentMethod = method;
        this.methodBtns.forEach(btn=>btn.classList.remove('method-active'));
        this.methodBtns.forEach(btn=>{if(btn.dataset.method===method) btn.classList.add('method-active');});
        this.methodSections.forEach(section=>section.classList.add('hidden'));
        const targetSection=document.getElementById(method.replace('-','')+'Section');
        if(targetSection) targetSection.classList.remove('hidden');
    }

    async processImage(){
        if(!this.currentImage){ alert('Select an image first'); return; }
        this.showProgress();
        await new Promise(resolve=>setTimeout(resolve,500)); // simulate processing
        this.applyBasicBackgroundRemoval();
        this.applyBackground();
        this.hideProgress();
    }

    applyBasicBackgroundRemoval() {
        const srcCtx = this.originalCtx;
        const tgtCtx = this.processedCtx;
        const canvas = this.processedCanvas;
        const imageData = srcCtx.getImageData(0,0,canvas.width,canvas.height);
        const data = imageData.data;
        for(let i=0;i<data.length;i+=4){
            const r=data[i], g=data[i+1], b=data[i+2];
            const luminance=0.299*r+0.587*g+0.114*b;
            if(luminance>200||(Math.abs(r-g)<30 && Math.abs(g-b)<30 && Math.abs(r-b)<30)){ data[i+3]=0; }
        }
        tgtCtx.putImageData(imageData,0,0);
    }

    applyBackground(){
        if(!this.currentImage) return;
        const canvas = this.processedCanvas;
        const ctx = canvas.getContext('2d');
        ctx.fillStyle=this.bgColorPicker.value||'#ffffff';
        ctx.fillRect(0,0,canvas.width,canvas.height);
        if(this.bgImage) ctx.drawImage(this.bgImage,0,0,canvas.width,canvas.height);
        const processedData = this.processedCtx.getImageData(0,0,canvas.width,canvas.height);
        ctx.putImageData(processedData,0,0);
    }

    downloadCanvas(canvas, filename){
        const link=document.createElement('a');
        link.download=filename;
        link.href=canvas.toDataURL();
        link.click();
    }

    showProgress(){ this.processingProgress.classList.remove('hidden'); this.processBtn.disabled=true; this.processBtn.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Processing...'; }
    hideProgress(){ this.processingProgress.classList.add('hidden'); this.processBtn.disabled=false; this.processBtn.innerHTML='<i class="fas fa-magic mr-2"></i>Process Image'; }
    resetAll(){
        this.currentImage=null; this.fileInput.value='';
        [this.originalCanvas,this.processedCanvas].forEach(c=>c.getContext('2d').clearRect(0,0,c.width,c.height));
        this.uploadArea.innerHTML=`<i class="fas fa-cloud-upload-alt text-5xl text-gray-400 mb-3"></i>
        <p class="text-lg text-gray-600 mb-2">Drag & drop your image here or click to select</p>
        <p class="text-sm text-gray-500">Supports JPG, PNG, WebP (Max 10MB)</p>`;
        this.bgImage=null;
    }
}

document.addEventListener('DOMContentLoaded',()=>{ new BackgroundRemoverTool(); });
</script>
</body>
</html>
